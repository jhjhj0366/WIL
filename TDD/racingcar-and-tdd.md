# 자동차 경주 게임과 TDD

## 설계

### 1차 목표 - 기능 요구사항 파악

<img width="599" alt="스크린샷_2022-06-20_오후_12 14 28" src="https://user-images.githubusercontent.com/92219795/174524208-adcb0f0e-6bce-45c6-908f-2b30a524c8bd.png">

### 2**차 목표 - 도메인을 기반으로 모델 설계**

MVC 패턴에서 생각한다면 View와 Controller에 집중하지 않고, 핵심 비즈니스 로직을 담당하는 Model 영역에 집중해야 한다.

여기에서 **뷰와 컨트롤러에서 순수한 모델을 분리**하는 것이 중요하고, 분리한 다음 도메인 객체에만 집중해서 단위 테스트에 집중해야 한다.

<img width="616" alt="스크린샷_2022-06-20_오전_11 42 23" src="https://user-images.githubusercontent.com/92219795/174524242-f58d7f62-ca57-48a3-869d-a2ae6fc51e80.png">

### 3**차 목표 - 테스트 가능한 부분과 테스트 하기 어려운 부분을 분리하라**

여기에서 random 값을 테스트하는 것이 정말 어렵다. 그렇기 때문에 도메인에서 테스트하기 어려운 Random 값 생성하는 구현체를 테스트하려는 도메인들과 분리해  나머지 영역들에 대해서 단위 테스트를 진행한다.

<img width="525" alt="스크린샷_2022-06-20_오전_11 46 37" src="https://user-images.githubusercontent.com/92219795/174524270-ae7a6ca9-4ea5-4de7-9f6e-6a351ded3e56.png">

> 💡 도메인 영역에서 단위 테스트를 진행 할때, 테스트하기 어려운 코드는 도메인에서 분리해 관리한다.

## 구현

### 4**차 목표 - TDD 진행**

1 단계 - Util 성격의 기능이 TDD로 도전하기 좋다.

- 1자 이상, 5자 이하의 정상적인 이름인지 확인
- 자동차 이동 거리에 따라 `-` 생성하기

2 단계 - 테스트 가능한 부분에 대해 TDD로 도전한다.

- 참여자의 이름 split하고 자동차 생성
- 경주에 참여한 자동차 중에서 우승자 찾기

3 단계 - 테스트하기 어려운 부분을 찾아 가능한 구조로 개선한다.

- 자동차 이동 유무
- 우승자 이름 출력하기

### 테스트

> **테스트하기 어려운 부분을 찾아 가능한 구조로 개선한다.**

 **Object Graph에서 다른 Object와 의존관계를 가지지 않는 마지막 노드를 먼저 찾는다.**
 예를 들어 RacingMain → RacingGame → Car와 같이 의존 관계를 가진다면 Car가 테스트 가능한지 확인한다.

**마지막 노드가 난수 생성일 때**

<img width="299" alt="스크린샷_2022-06-20_오후_12 33 18" src="https://user-images.githubusercontent.com/92219795/174524294-7a76256a-a741-4d0e-a0ac-6f5cfecdb70a.png">

**RacingGame에 난수 생성을 진행할 때**

<img width="288" alt="스크린샷_2022-06-20_오후_12 34 12" src="https://user-images.githubusercontent.com/92219795/174524325-d7a5dafa-aa7c-48da-9130-f6fc0e3c9020.png">

**RacingMain에서 난수 생성을 진행할 때**

<img width="295" alt="스크린샷_2022-06-20_오후_12 34 43" src="https://user-images.githubusercontent.com/92219795/174524343-0e2c0167-8bee-49d1-a136-f80457e2c706.png">

난수 생성이 제일 마지막에 오게 돼도 Mock 프레임워크를 사용해 테스트를 진행할 수 있지만 상위 노드로 난수 생성을 옮기면서 상위 노드를 제외한 하위 노드에서는 Mock 프레임워크 없이 테스트를 진행할 수 있다.

> 제일 첫 번째 노드에서는 테스트 진행이 어렵다. 보통 최상위 노드에서 테스트를 진행하려면 Mock 프레임워크를 이용해 테스트 해야 한다.